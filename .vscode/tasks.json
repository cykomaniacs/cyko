{ // See https://go.microsoft.com/fwlink/?LinkId=733558
  "version": "2.0.0",
  "tasks": [

    //+----------------------------------------------------------------------
    //| CLEAN: POWERSHELL
    //+----------------------------------------------------------------------

    { "label": "clean",
      "type":  "shell",
      "group": { "kind": "none", "isDefault": false }, "presentation": {
        "panel": "shared",
        "clear": true,
        "echo":  true,
        "close": false,
        "focus": false,
        "reveal": "always",
        "revealProblems": "onProblem",
        "showReuseMessage": false,
      },

      "options": { "cwd": "${workspaceFolder}" },
      "command": "./nuke.ps1", "args": [
        "-base", "'./bin'",
        "-name", "'debug', 'release'",
        "-arch", "'x64', 'x86'"
      ]
    },
    { "label": "debug-x64(clean)",
      "type":  "shell",
      "group": { "kind": "none", "isDefault": false }, "presentation": {
        "panel": "shared",
        "clear": true,
        "echo":  true,
        "close": false,
        "focus": false,
        "reveal": "always",
        "revealProblems": "onProblem",
        "showReuseMessage": false,
      },

      "options": { "cwd": "${workspaceFolder}" },
      "command": "./nuke.ps1", "args": [
        "-base", "'./bin'",
        "-name", "'debug'",
        "-arch", "'x64'"
      ]
    },

    //+----------------------------------------------------------------------
    //| BUILD: MANUAL CONFIG
    //+----------------------------------------------------------------------

    { "label": "win-debug-x64(msvc)",
      "type":  "cppbuild",

      "dependsOn": [
        "clean"
      ],

      "group": { "kind": "build", "isDefault": false, }, "presentation": {
        "panel": "shared",
        "clear": false,
        "echo":  true,
        "close": false,
        "focus": false,
        "reveal": "always",
        "revealProblems": "onProblem",
        "showReuseMessage": true,
      },

      "options": { "cwd": "${fileDirname}" },
      "command": "cl.exe", "args": [
        // ------------------------------------------------------------------
        // #region : misc

        "/options:strict", // unrecognized compiler options = error!!

        // #endregion
        // ------------------------------------------------------------------
        // #region : definitions

        "/DCYKO_DEBUG",
        // ------------------------------
        "/DCYKO_BUILD_TOOLKIT_MSVC",
        "/DCYKO_BUILD_CRT_MSVC", // LIBC
        "/DCYKO_BUILD_CXX_MSVC", // LIBCPP
        "/DCYKO_BUILD_X64",
        "/DCYKO_BUILD_WINDOWS",
        "/DCYKO_BUILD_USE_STDINT",
        // ------------------------------
        "/D_CONSOLE",
        "/D_UNICODE",

        // #endregion
        // ------------------------------------------------------------------
        // #region : includes

        "/I${workspaceFolder}/include",
        // ------------------------------
        "/FI${workspaceFolder}/include/cyko/common/common.h",

        // #endregion
        // ------------------------------------------------------------------
        // #region : base

        "/nologo",
        "/EHsc",

        // #endregion
        // ------------------------------------------------------------------
        // #region : language

        "/std:c++20",         // c++ standard version <c++(11|17|20)>
        "/fp:precise",        // floating-point model; results are predictable
        "/Gd",                // use __cdecl (default) calling convention for all functions except C++ member functions and functions that are marked __stdcall, __fastcall, or __vectorcall.
        "/Gm-",               // [-] enable minimal rebuild
        "/GS",                // [-] enable security checks
        "/sdl",               // enable additional security features and warnings
        "/utf-8",             // set source and execution character set to UTF-8
        "/permissive-",       // [-] enable some nonconforming code to compile

        // #endregion
        // ------------------------------------------------------------------
        // #region : diagnostics

        "/Wall", // warning level (<all>|[0-3])
        "/WX-",  // [-] treat warnings as errors

        // #endregion
        // ------------------------------------------------------------------
        // #region : optimization

        "/Od", // optimize level (disable: 0)

        // #endregion
        // ------------------------------------------------------------------
        // #region : debugging

        "/ZI", // enable Edit and Continue debug info (overrides /Zi)

        // #endregion
        // ------------------------------------------------------------------
        // #region : architecture
        // #endregion
        // ------------------------------------------------------------------
        // #region : i/o

        "/Fd:", "${workspaceFolder}/bin/debug/x64/vc143.pdb",
        "/Fo:", "${workspaceFolder}/bin/debug/x64/${fileBasenameNoExtension}.obj",
        "/Fe:", "${workspaceFolder}/bin/debug/x64/${fileBasenameNoExtension}.exe", "${file}"

        // #endregion
        // ------------------------------------------------------------------
      ],

      "problemMatcher": [ "$msCompile" ]
    },
    { "label": "win-debug-x64(llvm)",
      "type":  "cppbuild",

      "dependsOn": [
        "clean"
      ],

      "group": { "kind": "build", "isDefault": true, }, "presentation": {
        "panel": "shared",
        "clear": false,
        "echo":  true,
        "close": false,
        "focus": false,
        "reveal": "always",
        "revealProblems": "onProblem",
        "showReuseMessage": true
      },

      "options": { "cwd": "${workspaceFolder}" },
      "command": "clang++.exe", "args": [
        // ------------------------------------------------------------------
        // #region : misc
        // #endregion
        // ------------------------------------------------------------------
        // #region : definitions

        "-DCYKO_DEBUG",
        // ------------------------------
        "-DCYKO_BUILD_TOOLKIT_LLVM",
        "-DCYKO_BUILD_CRT_LLVM", // LIBCRT
        "-DCYKO_BUILD_CXX_MSVC", // LIBC++
        "-DCYKO_BUILD_X64",
        "-DCYKO_BUILD_WINDOWS",
        "-DCYKO_BUILD_USE_STDINT",
        // ------------------------------
        "-D_CONSOLE",
        "-D_UNICODE",

        // #endregion
        // ------------------------------------------------------------------
        // #region : includes

        "-I${workspaceFolder}/include",
        // ------------------------------
        "-include", "${workspaceFolder}/include/cyko/common/common.h",

        // #endregion
        // ------------------------------------------------------------------
        // #region : language

        "-std=c++2a",
        // C++ standard library to use. <arg> must be ‘libc++ (GCC)’, ‘libstdc++ (LLVM)’ or ‘platform’."
        "-fcxx-modules",
        "-fmodules",
        "-fmodules-ts",
        "-fimplicit-modules", // automatically translates #include directives into import statements (i.e. headers into modules).
        "-fimplicit-module-maps", // tells the compiler to implicitly search the file system for module map files.
        // A module map file is a file containing the mapping between existing headers and the logical structure of a module.


        // #endregion
        // ------------------------------------------------------------------
        // #region : diagnostics

        "-fansi-escape-codes", // dep: -fdiagnostics-color=always
        "-fdiagnostics-color", // dep: -fansi-escape-codes
        // ------------------------------
        "-Wall",
        "-Wextra",
        "-Wdeprecated",
        // ------------------------------
        "-Wno-unused-variable",

        // #endregion
        // ------------------------------------------------------------------
        // #region : optimization

        "-O0", // vsdebug requires -O0

        // #endregion
        // ------------------------------------------------------------------
        // #region : debugging
        "-fdebug-compilation-dir", "${workspaceFolder}/bin/debug/x64/",
        "-g",
        "-g3",
        "-gfull",
        "-gmodules",
        "-glldb",

        //"-fdebug-info-for-profiling",
        //"-fdebug-macro",
        //"-fdebug-pass-arguments",
        //"-fdebug-pass-structure",

        //-module-dependency-dir <arg> Directory to dump module dependencies to
        //-fdebug-compilation-dir=<arg>, -fdebug-compilation-dir <arg> The compilation directory to embed in the debug info
        // #endregion
        // ------------------------------------------------------------------
        // #region : architecture

        "-m64",

        // #endregion
        // ------------------------------------------------------------------
        // #region : i/o

        "${file}", "-Xclang", "-stdlib=libc++", "-o", "${workspaceFolder}/bin/debug/x64/${fileBasenameNoExtension}.exe"

        // #endregion
        // ------------------------------------------------------------------
      ],

      "problemMatcher": [ "$gcc" ]
    },

    //+----------------------------------------------------------------------
    //| BUILD: MSBUILD (VISUAL STUDIO CONFIG)
    //+----------------------------------------------------------------------

    { "label": "win-debug-x64(msbuild)",
      "type":  "cppbuild",

      "dependsOn": [
        "clean"
      ],

      "group": { "kind": "build", "isDefault": false, }, "presentation": {
        "panel": "shared",
        "clear": false,
        "echo":  true,
        "close": false,
        "focus": false,
        "reveal": "always",
        "revealProblems": "onProblem",
        "showReuseMessage": true
      },

      "options": { "cwd": "${workspaceFolder}" },
      "command": "msbuild.exe", "args": [
        "cyko.sln",
        "-p:Platform=x64",
        "-p:Configuration=debug"
      ],

      "problemMatcher": [
        "$msCompile"
      ]
    },
    { "label": "win-debug-x86(msbuild)",
      "type":  "cppbuild",

      "dependsOn": [
        "clean"
      ],

      "group": { "kind": "build", "isDefault": false, }, "presentation": {
        "panel": "shared",
        "clear": false,
        "echo":  true,
        "close": false,
        "focus": false,
        "reveal": "always",
        "revealProblems": "onProblem",
        "showReuseMessage": true
      },

      "options": { "cwd": "${workspaceFolder}" },
      "command": "msbuild.exe", "args": [
        "cyko.sln",
        "-p:Platform=x86",
        "-p:Configuration=debug"
      ],

      "problemMatcher": [
        "$msCompile"
      ]
    },
    { "label": "win-release-x64(msbuild)",
      "type":  "cppbuild",

      "dependsOn": [
        "clean"
      ],

      "group": { "kind": "build", "isDefault": false, }, "presentation": {
        "panel": "shared",
        "clear": false,
        "echo":  true,
        "close": false,
        "focus": false,
        "reveal": "always",
        "revealProblems": "onProblem",
        "showReuseMessage": true
      },

      "options": { "cwd": "${workspaceFolder}" },
      "command": "msbuild.exe", "args": [
        "cyko.sln",
        "-p:Platform=x64",
        "-p:Configuration=release"
      ],

      "problemMatcher": [
        "$msCompile"
      ]
    },
    { "label": "win-release-x86(msbuild)",
      "type":  "cppbuild",

      "dependsOn": [
        "clean"
      ],

      "group": { "kind": "build", "isDefault": false, }, "presentation": {
        "panel": "shared",
        "clear": false,
        "echo":  true,
        "close": false,
        "focus": false,
        "reveal": "always",
        "revealProblems": "onProblem",
        "showReuseMessage": true
      },

      "options": { "cwd": "${workspaceFolder}" },
      "command": "msbuild.exe", "args": [
        "cyko.sln",
        "-p:Platform=x86",
        "-p:Configuration=debug"
      ],

      "problemMatcher": [
        "$msCompile"
      ]
    }

  ]
}
